{% extends "base.html" %}

{% block title %}Manager Access - Team Feedback{% endblock %}
{% block header %}Manager Access{% endblock %}

{% block content %}
<div class="card content-centered">
    <h2 style="text-align: center; margin-bottom: 24px;">Manager Dashboard</h2>

    <p style="color: #666; margin-bottom: 24px; text-align: center;">
        Enter your name to access your team's feedback reports.
    </p>

    <form id="managerForm" onsubmit="continueAsManager(event)">
        <div class="form-group">
            <label>Your Name:</label>
            <input type="text" id="managerName" placeholder="Enter your name (e.g., Della Gate)" autofocus required>
        </div>

        <button type="submit" class="btn" style="width: 100%;">Continue</button>
    </form>

    {% if managers and managers|length > 0 %}
    <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid #eee;">
        <p style="color: #999; font-size: 13px; margin-bottom: 12px; text-align: center;">
            Or select from imported orgchart:
        </p>
        <select id="managerSelect" onchange="selectFromList()">
            <option value="">-- Select your name --</option>
            {% for manager in managers %}
            <option value="{{ manager.user_id }}" data-name="{{ manager.name }}">{{ manager.name }} ({{ manager.user_id }})</option>
            {% endfor %}
        </select>
    </div>
    {% endif %}

    <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid #eee; text-align: center;">
        <p style="color: #999; font-size: 13px; margin-bottom: 8px;">
            Tip: Bookmark a direct URL for faster access
        </p>
        <p style="color: #999; font-size: 12px; font-family: monospace;">
            /manager?name=Your%20Name
        </p>
    </div>

    <div style="margin-top: 20px; text-align: center;">
        <a href="/" style="color: #667eea; text-decoration: none; font-size: 14px;">&larr; Back to Home</a>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function continueAsManager(event) {
    if (event) event.preventDefault();

    const name = document.getElementById('managerName').value.trim();
    if (!name) {
        return;
    }

    // Redirect with name parameter
    window.location.href = '/manager?name=' + encodeURIComponent(name);
}

function selectFromList() {
    const select = document.getElementById('managerSelect');
    const option = select.options[select.selectedIndex];

    if (option.value) {
        // Use the stored user_id for orgchart-based login
        window.location.href = '/manager/' + option.value;
    }
}
</script>
{% endblock %}
